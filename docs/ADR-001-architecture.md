# ADR-001: Архитектурные решения

## Статус
Принято

## Контекст
Необходимо создать сервис на FastAPI для приёма и каталога записей с минимальными сущностями и базовой функциональностью.

## Решение

### Технологический стек
- **FastAPI** - веб-фреймворк для создания API
- **SQLAlchemy** - ORM для работы с базой данных
- **SQLite** - легковесная база данных для разработки
- **Pydantic** - валидация данных и сериализация
- **structlog** - структурированное JSON логирование
- **Uvicorn** - ASGI сервер

### Архитектурные принципы
1. **Модульность** - разделение на слои (API, модели, база данных)
2. **Dependency Injection** - использование FastAPI Depends
3. **Middleware** - централизованное логирование и трейсинг
4. **Health Checks** - эндпоинты для мониторинга
5. **OpenAPI** - автогенерация документации

### Структура проекта
```
app/
├── api/           # API эндпоинты
├── models/        # Pydantic и SQLAlchemy модели
├── database/      # Конфигурация БД
├── middleware/    # Middleware компоненты
└── main.py        # Точка входа
```

### Модель данных
- **Item** - основная сущность с полями:
  - `id` (Integer, автоинкремент, PK)
  - `sku` (String, уникальный, индекс)
  - `title` (String, обязательный)
  - `created_at` (DateTime, автозаполнение)

### Middleware
- **LoggingMiddleware** - логирование запросов с correlation-id
- **CORS** - поддержка кросс-доменных запросов

### Health Endpoints
- `/healthz` - liveness probe (проверка что сервис запущен)
- `/readyz` - readiness probe (проверка готовности к работе)

## Последствия

### Положительные
- Быстрая разработка и тестирование
- Автоматическая документация API
- Структурированное логирование
- Готовность к деплою в Kubernetes

### Отрицательные
- SQLite не подходит для высоких нагрузок
- Отсутствие аутентификации и авторизации
- Простая пагинация (пока)

## Альтернативы
- **Django** - более тяжелый фреймворк
- **PostgreSQL** - избыточно для начального этапа
- **Flask** - менее функциональный для API



